function Me(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Uo(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ne(t,...e){if(!Uo(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function he(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Me(t.outputLen),Me(t.blockLen)}function re(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function sr(t,e){ne(t);let n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var Wt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ve(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Bt(t,e){return t<<32-e|t>>>e}function pe(t,e){return t<<e|t>>>32-e>>>0}var Io=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",_o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function nn(t){if(ne(t),Io)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=_o[t[n]];return e}function ir(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Ht(t){return typeof t=="string"&&(t=ir(t)),ne(t),t}var oe=class{clone(){return this._cloneInto()}};function se(t){let e=r=>t().update(Ht(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function rn(t=32){if(Wt&&typeof Wt.getRandomValues=="function")return Wt.getRandomValues(new Uint8Array(t));if(Wt&&typeof Wt.randomBytes=="function")return Uint8Array.from(Wt.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Oo(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,l=r?0:4;t.setUint32(e+f,i,r),t.setUint32(e+l,c,r)}function cr(t,e,n){return t&e^~t&n}function fr(t,e,n){return t&e^t&n^e&n}var Dt=class extends oe{constructor(e,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(e),this.view=ve(this.buffer)}update(e){re(this);let{view:n,buffer:r,blockLen:o}=this;e=Ht(e);let s=e.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=ve(e);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(e.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){re(this),sr(e,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let y=i;y<o;y++)n[y]=0;Oo(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=ve(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=f/4,h=this.get();if(l>h.length)throw new Error("_sha2: outputLen bigger than state");for(let y=0;y<l;y++)c.setUint32(4*y,h[y],s)}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return e.length=o,e.pos=c,e.finished=s,e.destroyed=i,o%n&&e.buffer.set(r),e}};var Lo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ft=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pt=new Uint32Array(64),on=class extends Dt{constructor(e=32){super(64,e,8,!1),this.A=Ft[0]|0,this.B=Ft[1]|0,this.C=Ft[2]|0,this.D=Ft[3]|0,this.E=Ft[4]|0,this.F=Ft[5]|0,this.G=Ft[6]|0,this.H=Ft[7]|0}get(){let{A:e,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[e,n,r,o,s,i,c,f]}set(e,n,r,o,s,i,c,f){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(e,n){for(let y=0;y<16;y++,n+=4)Pt[y]=e.getUint32(n,!1);for(let y=16;y<64;y++){let m=Pt[y-15],b=Pt[y-2],_=Bt(m,7)^Bt(m,18)^m>>>3,U=Bt(b,17)^Bt(b,19)^b>>>10;Pt[y]=U+Pt[y-7]+_+Pt[y-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:l,H:h}=this;for(let y=0;y<64;y++){let m=Bt(c,6)^Bt(c,11)^Bt(c,25),b=h+m+cr(c,f,l)+Lo[y]+Pt[y]|0,U=(Bt(r,2)^Bt(r,13)^Bt(r,22))+fr(r,o,s)|0;h=l,l=f,f=c,c=i+b|0,i=s,s=o,o=r,r=b+U|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,l=l+this.G|0,h=h+this.H|0,this.set(r,o,s,i,c,f,l,h)}roundClean(){Pt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var ar=se(()=>new on);var Re=BigInt(4294967295),sn=BigInt(32);function lr(t,e=!1){return e?{h:Number(t&Re),l:Number(t>>sn&Re)}:{h:Number(t>>sn&Re)|0,l:Number(t&Re)|0}}function To(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let o=0;o<t.length;o++){let{h:s,l:i}=lr(t[o],e);[n[o],r[o]]=[s,i]}return[n,r]}var Co=(t,e)=>BigInt(t>>>0)<<sn|BigInt(e>>>0),Mo=(t,e,n)=>t>>>n,vo=(t,e,n)=>t<<32-n|e>>>n,Ro=(t,e,n)=>t>>>n|e<<32-n,ko=(t,e,n)=>t<<32-n|e>>>n,No=(t,e,n)=>t<<64-n|e>>>n-32,Ho=(t,e,n)=>t>>>n-32|e<<64-n,Do=(t,e)=>e,Fo=(t,e)=>t,Po=(t,e,n)=>t<<n|e>>>32-n,Vo=(t,e,n)=>e<<n|t>>>32-n,Ko=(t,e,n)=>e<<n-32|t>>>64-n,jo=(t,e,n)=>t<<n-32|e>>>64-n;function zo(t,e,n,r){let o=(e>>>0)+(r>>>0);return{h:t+n+(o/2**32|0)|0,l:o|0}}var qo=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Zo=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,Go=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Wo=(t,e,n,r,o)=>e+n+r+o+(t/2**32|0)|0,Yo=(t,e,n,r,o)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(o>>>0),$o=(t,e,n,r,o,s)=>e+n+r+o+s+(t/2**32|0)|0;var Xo={fromBig:lr,split:To,toBig:Co,shrSH:Mo,shrSL:vo,rotrSH:Ro,rotrSL:ko,rotrBH:No,rotrBL:Ho,rotr32H:Do,rotr32L:Fo,rotlSH:Po,rotlSL:Vo,rotlBH:Ko,rotlBL:jo,add:zo,add3L:qo,add3H:Zo,add4L:Go,add4H:Wo,add5H:$o,add5L:Yo},N=Xo;var[Jo,Qo]=N.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Vt=new Uint32Array(80),Kt=new Uint32Array(80),cn=class extends Dt{constructor(e=64){super(128,e,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:f,Eh:l,El:h,Fh:y,Fl:m,Gh:b,Gl:_,Hh:U,Hl:C}=this;return[e,n,r,o,s,i,c,f,l,h,y,m,b,_,U,C]}set(e,n,r,o,s,i,c,f,l,h,y,m,b,_,U,C){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=f|0,this.Eh=l|0,this.El=h|0,this.Fh=y|0,this.Fl=m|0,this.Gh=b|0,this.Gl=_|0,this.Hh=U|0,this.Hl=C|0}process(e,n){for(let A=0;A<16;A++,n+=4)Vt[A]=e.getUint32(n),Kt[A]=e.getUint32(n+=4);for(let A=16;A<80;A++){let S=Vt[A-15]|0,k=Kt[A-15]|0,H=N.rotrSH(S,k,1)^N.rotrSH(S,k,8)^N.shrSH(S,k,7),V=N.rotrSL(S,k,1)^N.rotrSL(S,k,8)^N.shrSL(S,k,7),K=Vt[A-2]|0,P=Kt[A-2]|0,W=N.rotrSH(K,P,19)^N.rotrBH(K,P,61)^N.shrSH(K,P,6),q=N.rotrSL(K,P,19)^N.rotrBL(K,P,61)^N.shrSL(K,P,6),it=N.add4L(V,q,Kt[A-7],Kt[A-16]),yt=N.add4H(it,H,W,Vt[A-7],Vt[A-16]);Vt[A]=yt|0,Kt[A]=it|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:f,Dh:l,Dl:h,Eh:y,El:m,Fh:b,Fl:_,Gh:U,Gl:C,Hh:R,Hl:T}=this;for(let A=0;A<80;A++){let S=N.rotrSH(y,m,14)^N.rotrSH(y,m,18)^N.rotrBH(y,m,41),k=N.rotrSL(y,m,14)^N.rotrSL(y,m,18)^N.rotrBL(y,m,41),H=y&b^~y&U,V=m&_^~m&C,K=N.add5L(T,k,V,Qo[A],Kt[A]),P=N.add5H(K,R,S,H,Jo[A],Vt[A]),W=K|0,q=N.rotrSH(r,o,28)^N.rotrBH(r,o,34)^N.rotrBH(r,o,39),it=N.rotrSL(r,o,28)^N.rotrBL(r,o,34)^N.rotrBL(r,o,39),yt=r&s^r&c^s&c,d=o&i^o&f^i&f;R=U|0,T=C|0,U=b|0,C=_|0,b=y|0,_=m|0,{h:y,l:m}=N.add(l|0,h|0,P|0,W|0),l=c|0,h=f|0,c=s|0,f=i|0,s=r|0,i=o|0;let L=N.add3L(W,it,d);r=N.add3H(L,P,q,yt),o=L|0}({h:r,l:o}=N.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=N.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:f}=N.add(this.Ch|0,this.Cl|0,c|0,f|0),{h:l,l:h}=N.add(this.Dh|0,this.Dl|0,l|0,h|0),{h:y,l:m}=N.add(this.Eh|0,this.El|0,y|0,m|0),{h:b,l:_}=N.add(this.Fh|0,this.Fl|0,b|0,_|0),{h:U,l:C}=N.add(this.Gh|0,this.Gl|0,U|0,C|0),{h:R,l:T}=N.add(this.Hh|0,this.Hl|0,R|0,T|0),this.set(r,o,s,i,c,f,l,h,y,m,b,_,U,C,R,T)}roundClean(){Vt.fill(0),Kt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var fn=se(()=>new cn);var un=BigInt(0),ln=BigInt(1);function dn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function hn(t){if(!dn(t))throw new Error("Uint8Array expected")}function ke(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function dr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?un:BigInt("0x"+t)}var hr=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ts=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ne(t){if(hn(t),hr)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=ts[t[n]];return e}var Tt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ur(t){if(t>=Tt._0&&t<=Tt._9)return t-Tt._0;if(t>=Tt.A&&t<=Tt.F)return t-(Tt.A-10);if(t>=Tt.a&&t<=Tt.f)return t-(Tt.a-10)}function pr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(hr)return Uint8Array.fromHex(t);let e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=ur(t.charCodeAt(s)),c=ur(t.charCodeAt(s+1));if(i===void 0||c===void 0){let f=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[o]=i*16+c}return r}function xr(t){return dr(Ne(t))}function Ct(t){return hn(t),dr(Ne(Uint8Array.from(t).reverse()))}function pn(t,e){return pr(t.toString(16).padStart(e*2,"0"))}function Yt(t,e){return pn(t,e).reverse()}function lt(t,e,n){let r;if(typeof e=="string")try{r=pr(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(dn(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(t+" of length "+n+" expected, got "+o);return r}function xn(...t){let e=0;for(let r=0;r<t.length;r++){let o=t[r];hn(o),e+=o.length}let n=new Uint8Array(e);for(let r=0,o=0;r<t.length;r++){let s=t[r];n.set(s,o),o+=s.length}return n}var an=t=>typeof t=="bigint"&&un<=t;function es(t,e,n){return an(t)&&an(e)&&an(n)&&e<=t&&t<n}function Mt(t,e,n,r){if(!es(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function yr(t){let e;for(e=0;t>un;t>>=ln,e+=1);return e}var xe=t=>(ln<<BigInt(t))-ln;var ns={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||dn(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function jt(t,e,n={}){let r=(o,s,i)=>{let c=ns[s];if(typeof c!="function")throw new Error("invalid validator function");let f=t[o];if(!(i&&f===void 0)&&!c(f,t))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+f)};for(let[o,s]of Object.entries(e))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return t}function yn(t){let e=new WeakMap;return(n,...r)=>{let o=e.get(n);if(o!==void 0)return o;let s=t(n,...r);return e.set(n,s),s}}var tt=BigInt(0),$=BigInt(1),$t=BigInt(2),rs=BigInt(3),gn=BigInt(4),gr=BigInt(5),wr=BigInt(8),os=BigInt(9),ss=BigInt(16);function Y(t,e){let n=t%e;return n>=tt?n:e+n}function wn(t,e,n){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(n<=tt)throw new Error("invalid modulus");if(n===$)return tt;let r=$;for(;e>tt;)e&$&&(r=r*t%n),t=t*t%n,e>>=$;return r}function wt(t,e,n){let r=t;for(;e-- >tt;)r*=r,r%=n;return r}function br(t,e){if(t===tt)throw new Error("invert: expected non-zero number");if(e<=tt)throw new Error("invert: expected positive modulus, got "+e);let n=Y(t,e),r=e,o=tt,s=$,i=$,c=tt;for(;n!==tt;){let l=r/n,h=r%n,y=o-i*l,m=s-c*l;r=n,n=h,o=i,s=c,i=y,c=m}if(r!==$)throw new Error("invert: does not exist");return Y(o,e)}function is(t){let e=(t-$)/$t,n,r,o;for(n=t-$,r=0;n%$t===tt;n/=$t,r++);for(o=$t;o<t&&wn(o,e,t)!==t-$;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){let i=(t+$)/gn;return function(f,l){let h=f.pow(l,i);if(!f.eql(f.sqr(h),l))throw new Error("Cannot find square root");return h}}let s=(n+$)/$t;return function(c,f){if(c.pow(f,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=r,h=c.pow(c.mul(c.ONE,o),n),y=c.pow(f,s),m=c.pow(f,n);for(;!c.eql(m,c.ONE);){if(c.eql(m,c.ZERO))return c.ZERO;let b=1;for(let U=c.sqr(m);b<l&&!c.eql(U,c.ONE);b++)U=c.sqr(U);let _=c.pow(h,$<<BigInt(l-b-1));h=c.sqr(_),y=c.mul(y,_),m=c.mul(m,h),l=b}return y}}function cs(t){if(t%gn===rs){let e=(t+$)/gn;return function(r,o){let s=r.pow(o,e);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(t%wr===gr){let e=(t-gr)/wr;return function(r,o){let s=r.mul(o,$t),i=r.pow(s,e),c=r.mul(o,i),f=r.mul(r.mul(c,$t),i),l=r.mul(c,r.sub(f,r.ONE));if(!r.eql(r.sqr(l),o))throw new Error("Cannot find square root");return l}}return t%ss,is(t)}var mr=(t,e)=>(Y(t,e)&$)===$,fs=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Er(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=fs.reduce((r,o)=>(r[o]="function",r),e);return jt(t,n)}function as(t,e,n){if(n<tt)throw new Error("invalid exponent, negatives unsupported");if(n===tt)return t.ONE;if(n===$)return e;let r=t.ONE,o=e;for(;n>tt;)n&$&&(r=t.mul(r,o)),o=t.sqr(o),n>>=$;return r}function ls(t,e){let n=new Array(e.length),r=e.reduce((s,i,c)=>t.is0(i)?s:(n[c]=s,t.mul(s,i)),t.ONE),o=t.inv(r);return e.reduceRight((s,i,c)=>t.is0(i)?s:(n[c]=t.mul(s,n[c]),t.mul(s,i)),o),n}function bn(t,e){let n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function He(t,e,n=!1,r={}){if(t<=tt)throw new Error("invalid field: expected ORDER > 0, got "+t);let{nBitLength:o,nByteLength:s}=bn(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,c=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:s,MASK:xe(o),ZERO:tt,ONE:$,create:f=>Y(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return tt<=f&&f<t},is0:f=>f===tt,isOdd:f=>(f&$)===$,neg:f=>Y(-f,t),eql:(f,l)=>f===l,sqr:f=>Y(f*f,t),add:(f,l)=>Y(f+l,t),sub:(f,l)=>Y(f-l,t),mul:(f,l)=>Y(f*l,t),pow:(f,l)=>as(c,f,l),div:(f,l)=>Y(f*br(l,t),t),sqrN:f=>f*f,addN:(f,l)=>f+l,subN:(f,l)=>f-l,mulN:(f,l)=>f*l,inv:f=>br(f,t),sqrt:r.sqrt||(f=>(i||(i=cs(t)),i(c,f))),invertBatch:f=>ls(c,f),cmov:(f,l,h)=>h?l:f,toBytes:f=>n?Yt(f,s):pn(f,s),fromBytes:f=>{if(f.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+f.length);return n?Ct(f):xr(f)}});return Object.freeze(c)}var Br=BigInt(0),Sn=BigInt(1);function mn(t,e){let n=e.negate();return t?n:e}function Sr(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function En(t,e){Sr(t,e);let n=Math.ceil(e/t)+1,r=2**(t-1),o=2**t,s=xe(t),i=BigInt(t);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:i}}function Ar(t,e,n){let{windowSize:r,mask:o,maxNumber:s,shiftBy:i}=n,c=Number(t&o),f=t>>i;c>r&&(c-=s,f+=Sn);let l=e*r,h=l+Math.abs(c)-1,y=c===0,m=c<0,b=e%2!==0;return{nextN:f,offset:h,isZero:y,isNeg:m,isNegF:b,offsetF:l}}function us(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function ds(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}var Bn=new WeakMap,Ur=new WeakMap;function An(t){return Ur.get(t)||1}function Ir(t,e){return{constTimeNegate:mn,hasPrecomputes(n){return An(n)!==1},unsafeLadder(n,r,o=t.ZERO){let s=n;for(;r>Br;)r&Sn&&(o=o.add(s)),s=s.double(),r>>=Sn;return o},precomputeWindow(n,r){let{windows:o,windowSize:s}=En(r,e),i=[],c=n,f=c;for(let l=0;l<o;l++){f=c,i.push(f);for(let h=1;h<s;h++)f=f.add(c),i.push(f);c=f.double()}return i},wNAF(n,r,o){let s=t.ZERO,i=t.BASE,c=En(n,e);for(let f=0;f<c.windows;f++){let{nextN:l,offset:h,isZero:y,isNeg:m,isNegF:b,offsetF:_}=Ar(o,f,c);o=l,y?i=i.add(mn(b,r[_])):s=s.add(mn(m,r[h]))}return{p:s,f:i}},wNAFUnsafe(n,r,o,s=t.ZERO){let i=En(n,e);for(let c=0;c<i.windows&&o!==Br;c++){let{nextN:f,offset:l,isZero:h,isNeg:y}=Ar(o,c,i);if(o=f,!h){let m=r[l];s=s.add(y?m.negate():m)}}return s},getPrecomputes(n,r,o){let s=Bn.get(r);return s||(s=this.precomputeWindow(r,n),n!==1&&Bn.set(r,o(s))),s},wNAFCached(n,r,o){let s=An(n);return this.wNAF(s,this.getPrecomputes(s,n,o),r)},wNAFCachedUnsafe(n,r,o,s){let i=An(n);return i===1?this.unsafeLadder(n,r,s):this.wNAFUnsafe(i,this.getPrecomputes(i,n,o),r,s)},setWindowSize(n,r){Sr(r,e),Ur.set(n,r),Bn.delete(n)}}}function _r(t,e,n,r){if(us(n,t),ds(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");let o=t.ZERO,s=yr(BigInt(n.length)),i=s>12?s-3:s>4?s-2:s?2:1,c=xe(i),f=new Array(Number(c)+1).fill(o),l=Math.floor((e.BITS-1)/i)*i,h=o;for(let y=l;y>=0;y-=i){f.fill(o);for(let b=0;b<r.length;b++){let _=r[b],U=Number(_>>BigInt(y)&c);f[U]=f[U].add(n[b])}let m=o;for(let b=f.length-1,_=o;b>0;b--)_=_.add(f[b]),m=m.add(_);if(h=h.add(m),y!==0)for(let b=0;b<i;b++)h=h.double()}return h}function Or(t){return Er(t.Fp),jt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...bn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var It=BigInt(0),ct=BigInt(1),Lr=BigInt(2),hs=BigInt(8),ps={zip215:!0};function xs(t){let e=Or(t);return jt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Tr(t){let e=xs(t),{Fp:n,n:r,prehash:o,hash:s,randomBytes:i,nByteLength:c,h:f}=e,l=Lr<<BigInt(c*8)-ct,h=n.create,y=He(e.n,e.nBitLength),m=e.uvRatio||((x,u)=>{try{return{isValid:!0,value:n.sqrt(x*n.inv(u))}}catch{return{isValid:!1,value:It}}}),b=e.adjustScalarBytes||(x=>x),_=e.domain||((x,u,w)=>{if(ke("phflag",w),u.length||w)throw new Error("Contexts/pre-hash are not supported");return x});function U(x,u,w=!1){let B=w?ct:It;Mt("coordinate "+x,u,B,l)}function C(x){if(!(x instanceof A))throw new Error("ExtendedPoint expected")}let R=yn((x,u)=>{let{ex:w,ey:B,ez:I}=x,O=x.is0();u==null&&(u=O?hs:n.inv(I));let v=h(w*u),Z=h(B*u),j=h(I*u);if(O)return{x:It,y:ct};if(j!==ct)throw new Error("invZ was invalid");return{x:v,y:Z}}),T=yn(x=>{let{a:u,d:w}=e;if(x.is0())throw new Error("bad point: ZERO");let{ex:B,ey:I,ez:O,et:v}=x,Z=h(B*B),j=h(I*I),J=h(O*O),ot=h(J*J),pt=h(Z*u),St=h(J*h(pt+j)),Ut=h(ot+h(w*h(Z*j)));if(St!==Ut)throw new Error("bad point: equation left != right (1)");let gt=h(B*I),Nt=h(O*v);if(gt!==Nt)throw new Error("bad point: equation left != right (2)");return!0});class A{constructor(u,w,B,I){U("x",u),U("y",w),U("z",B,!0),U("t",I),this.ex=u,this.ey=w,this.ez=B,this.et=I,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(u){if(u instanceof A)throw new Error("extended point not allowed");let{x:w,y:B}=u||{};return U("x",w),U("y",B),new A(w,B,ct,h(w*B))}static normalizeZ(u){let w=n.invertBatch(u.map(B=>B.ez));return u.map((B,I)=>B.toAffine(w[I])).map(A.fromAffine)}static msm(u,w){return _r(A,y,u,w)}_setWindowSize(u){H.setWindowSize(this,u)}assertValidity(){T(this)}equals(u){C(u);let{ex:w,ey:B,ez:I}=this,{ex:O,ey:v,ez:Z}=u,j=h(w*Z),J=h(O*I),ot=h(B*Z),pt=h(v*I);return j===J&&ot===pt}is0(){return this.equals(A.ZERO)}negate(){return new A(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){let{a:u}=e,{ex:w,ey:B,ez:I}=this,O=h(w*w),v=h(B*B),Z=h(Lr*h(I*I)),j=h(u*O),J=w+B,ot=h(h(J*J)-O-v),pt=j+v,St=pt-Z,Ut=j-v,gt=h(ot*St),Nt=h(pt*Ut),Gt=h(ot*Ut),Ce=h(St*pt);return new A(gt,Nt,Ce,Gt)}add(u){C(u);let{a:w,d:B}=e,{ex:I,ey:O,ez:v,et:Z}=this,{ex:j,ey:J,ez:ot,et:pt}=u,St=h(I*j),Ut=h(O*J),gt=h(Z*B*pt),Nt=h(v*ot),Gt=h((I+O)*(j+J)-St-Ut),Ce=Nt-gt,rr=Nt+gt,or=h(Ut-w*St),Eo=h(Gt*Ce),Bo=h(rr*or),Ao=h(Gt*or),So=h(Ce*rr);return new A(Eo,Bo,So,Ao)}subtract(u){return this.add(u.negate())}wNAF(u){return H.wNAFCached(this,u,A.normalizeZ)}multiply(u){let w=u;Mt("scalar",w,ct,r);let{p:B,f:I}=this.wNAF(w);return A.normalizeZ([B,I])[0]}multiplyUnsafe(u,w=A.ZERO){let B=u;return Mt("scalar",B,It,r),B===It?k:this.is0()||B===ct?this:H.wNAFCachedUnsafe(this,B,A.normalizeZ,w)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return H.unsafeLadder(this,r).is0()}toAffine(u){return R(this,u)}clearCofactor(){let{h:u}=e;return u===ct?this:this.multiplyUnsafe(u)}static fromHex(u,w=!1){let{d:B,a:I}=e,O=n.BYTES;u=lt("pointHex",u,O),ke("zip215",w);let v=u.slice(),Z=u[O-1];v[O-1]=Z&-129;let j=Ct(v),J=w?l:n.ORDER;Mt("pointHex.y",j,It,J);let ot=h(j*j),pt=h(ot-ct),St=h(B*ot-I),{isValid:Ut,value:gt}=m(pt,St);if(!Ut)throw new Error("Point.fromHex: invalid y coordinate");let Nt=(gt&ct)===ct,Gt=(Z&128)!==0;if(!w&&gt===It&&Gt)throw new Error("Point.fromHex: x=0 and x_0=1");return Gt!==Nt&&(gt=h(-gt)),A.fromAffine({x:gt,y:j})}static fromPrivateKey(u){let{scalar:w}=P(u);return S.multiply(w)}toRawBytes(){let{x:u,y:w}=this.toAffine(),B=Yt(w,n.BYTES);return B[B.length-1]|=u&ct?128:0,B}toHex(){return Ne(this.toRawBytes())}}A.BASE=new A(e.Gx,e.Gy,ct,h(e.Gx*e.Gy)),A.ZERO=new A(It,ct,ct,It);let{BASE:S,ZERO:k}=A,H=Ir(A,c*8);function V(x){return Y(x,r)}function K(x){return V(Ct(x))}function P(x){let u=n.BYTES;x=lt("private key",x,u);let w=lt("hashed private key",s(x),2*u),B=b(w.slice(0,u)),I=w.slice(u,2*u),O=K(B);return{head:B,prefix:I,scalar:O}}function W(x){let{head:u,prefix:w,scalar:B}=P(x),I=S.multiply(B),O=I.toRawBytes();return{head:u,prefix:w,scalar:B,point:I,pointBytes:O}}function q(x){return W(x).pointBytes}function it(x=new Uint8Array,...u){let w=xn(...u);return K(s(_(w,lt("context",x),!!o)))}function yt(x,u,w={}){x=lt("message",x),o&&(x=o(x));let{prefix:B,scalar:I,pointBytes:O}=W(u),v=it(w.context,B,x),Z=S.multiply(v).toRawBytes(),j=it(w.context,Z,O,x),J=V(v+j*I);Mt("signature.s",J,It,r);let ot=xn(Z,Yt(J,n.BYTES));return lt("result",ot,n.BYTES*2)}let d=ps;function L(x,u,w,B=d){let{context:I,zip215:O}=B,v=n.BYTES;x=lt("signature",x,2*v),u=lt("message",u),w=lt("publicKey",w,v),O!==void 0&&ke("zip215",O),o&&(u=o(u));let Z=Ct(x.slice(v,2*v)),j,J,ot;try{j=A.fromHex(w,O),J=A.fromHex(x.slice(0,v),O),ot=S.multiplyUnsafe(Z)}catch{return!1}if(!O&&j.isSmallOrder())return!1;let pt=it(I,J.toRawBytes(),j.toRawBytes(),u);return J.add(j.multiplyUnsafe(pt)).subtract(ot).clearCofactor().equals(A.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:q,sign:yt,verify:L,ExtendedPoint:A,utils:{getExtendedPublicKey:W,randomPrivateKey:()=>i(n.BYTES),precompute(x=8,u=A.BASE){return u._setWindowSize(x),u.multiply(BigInt(3)),u}}}}var ie=BigInt(0),Un=BigInt(1);function ys(t){return jt(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Cr(t){let e=ys(t),{P:n}=e,r=T=>Y(T,n),o=e.montgomeryBits,s=Math.ceil(o/8),i=e.nByteLength,c=e.adjustScalarBytes||(T=>T),f=e.powPminus2||(T=>wn(T,n-BigInt(2),n));function l(T,A,S){let k=r(T*(A-S));return A=r(A-k),S=r(S+k),[A,S]}let h=(e.a-BigInt(2))/BigInt(4);function y(T,A){Mt("u",T,ie,n),Mt("scalar",A,ie,n);let S=A,k=T,H=Un,V=ie,K=T,P=Un,W=ie,q;for(let yt=BigInt(o-1);yt>=ie;yt--){let d=S>>yt&Un;W^=d,q=l(W,H,K),H=q[0],K=q[1],q=l(W,V,P),V=q[0],P=q[1],W=d;let L=H+V,E=r(L*L),x=H-V,u=r(x*x),w=E-u,B=K+P,I=K-P,O=r(I*L),v=r(B*x),Z=O+v,j=O-v;K=r(Z*Z),P=r(k*r(j*j)),H=r(E*u),V=r(w*(E+r(h*w)))}q=l(W,H,K),H=q[0],K=q[1],q=l(W,V,P),V=q[0],P=q[1];let it=f(V);return r(H*it)}function m(T){return Yt(r(T),s)}function b(T){let A=lt("u coordinate",T,s);return i===32&&(A[31]&=127),Ct(A)}function _(T){let A=lt("scalar",T),S=A.length;if(S!==s&&S!==i){let k=""+s+" or "+i;throw new Error("invalid scalar, expected "+k+" bytes, got "+S)}return Ct(c(A))}function U(T,A){let S=b(A),k=_(T),H=y(S,k);if(H===ie)throw new Error("invalid private or public key received");return m(H)}let C=m(e.Gu);function R(T){return U(T,C)}return{scalarMult:U,scalarMultBase:R,getSharedSecret:(T,A)=>U(T,A),getPublicKey:T=>R(T),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:C}}var ge=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Mr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),lc=BigInt(0),gs=BigInt(1),vr=BigInt(2),ws=BigInt(3),bs=BigInt(5),ms=BigInt(8);function Rr(t){let e=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=ge,c=t*t%s*t%s,f=wt(c,vr,s)*c%s,l=wt(f,gs,s)*t%s,h=wt(l,bs,s)*l%s,y=wt(h,e,s)*h%s,m=wt(y,n,s)*y%s,b=wt(m,r,s)*m%s,_=wt(b,o,s)*b%s,U=wt(_,o,s)*b%s,C=wt(U,e,s)*h%s;return{pow_p_5_8:wt(C,vr,s)*t%s,b2:c}}function kr(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Es(t,e){let n=ge,r=Y(e*e*e,n),o=Y(r*r*e,n),s=Rr(t*o).pow_p_5_8,i=Y(t*r*s,n),c=Y(e*i*i,n),f=i,l=Y(i*Mr,n),h=c===t,y=c===Y(-t,n),m=c===Y(-t*Mr,n);return h&&(i=f),(y||m)&&(i=l),mr(i,n)&&(i=Y(-i,n)),{isValid:h||y,value:i}}var ye=He(ge,void 0,!0),In={a:ye.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ye,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ms,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:fn,randomBytes:rn,adjustScalarBytes:kr,uvRatio:Es},Xt=Tr(In);var we=Cr({P:ge,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=ge,{pow_p_5_8:n,b2:r}=Rr(t);return Y(wt(n,ws,e)*r,e)},adjustScalarBytes:kr,randomBytes:rn});function Nr(t){let{y:e}=Xt.ExtendedPoint.fromHex(t),n=BigInt(1);return ye.toBytes(ye.create((n+e)*ye.inv(n-e)))}function Hr(t){let e=In.hash(t.subarray(0,32));return In.adjustScalarBytes(e).subarray(0,32)}var Bs=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Fr=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),As=Fr.map(t=>(9*t+5)%16),On=[Fr],Ln=[As];for(let t=0;t<4;t++)for(let e of[On,Ln])e.push(e[t].map(n=>Bs[n]));var Pr=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),Ss=On.map((t,e)=>t.map(n=>Pr[e][n])),Us=Ln.map((t,e)=>t.map(n=>Pr[e][n])),Is=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),_s=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Dr(t,e,n,r){return t===0?e^n^r:t===1?e&n|~e&r:t===2?(e|~n)^r:t===3?e&r|n&~r:e^(n|~r)}var De=new Uint32Array(16),_n=class extends Dt{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:e,h1:n,h2:r,h3:o,h4:s}=this;return[e,n,r,o,s]}set(e,n,r,o,s){this.h0=e|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=s|0}process(e,n){for(let b=0;b<16;b++,n+=4)De[b]=e.getUint32(n,!0);let r=this.h0|0,o=r,s=this.h1|0,i=s,c=this.h2|0,f=c,l=this.h3|0,h=l,y=this.h4|0,m=y;for(let b=0;b<5;b++){let _=4-b,U=Is[b],C=_s[b],R=On[b],T=Ln[b],A=Ss[b],S=Us[b];for(let k=0;k<16;k++){let H=pe(r+Dr(b,s,c,l)+De[R[k]]+U,A[k])+y|0;r=y,y=l,l=pe(c,10)|0,c=s,s=H}for(let k=0;k<16;k++){let H=pe(o+Dr(_,i,f,h)+De[T[k]]+C,S[k])+m|0;o=m,m=h,h=pe(f,10)|0,f=i,i=H}}this.set(this.h1+c+h|0,this.h2+l+m|0,this.h3+y+o|0,this.h4+r+i|0,this.h0+s+f|0)}roundClean(){De.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}},Vr=se(()=>new _n);var Fe=class extends oe{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,he(e);let r=Ht(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?e.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return re(this),this.iHash.update(e),this}digestInto(e){re(this),ne(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Pe=(t,e,n)=>new Fe(t,e).update(n).digest();Pe.create=(t,e)=>new Fe(t,e);function Os(t,e,n){return he(t),n===void 0&&(n=new Uint8Array(t.outputLen)),Pe(t,Ht(n),Ht(e))}var Tn=new Uint8Array([0]),Kr=new Uint8Array;function Ls(t,e,n,r=32){if(he(t),Me(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let o=Math.ceil(r/t.outputLen);n===void 0&&(n=Kr);let s=new Uint8Array(o*t.outputLen),i=Pe.create(t,e),c=i._cloneInto(),f=new Uint8Array(i.outputLen);for(let l=0;l<o;l++)Tn[0]=l+1,c.update(l===0?Kr:f).update(n).update(Tn).digestInto(f),s.set(f,t.outputLen*l),i._cloneInto(c);return i.destroy(),c.destroy(),f.fill(0),Tn.fill(0),s.slice(0,r)}var jr=(t,e,n,r,o)=>Ls(t,Os(t,e,n),r,o);function Cn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function st(t,...e){if(!Cn(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function be(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Mn(t,e){st(t);let n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var zr=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),ft=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),me=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ts=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ts)throw new Error("Non little-endian hardware is not supported");function Cs(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ce(t){if(typeof t=="string")t=Cs(t);else if(Cn(t))t=vt(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function qr(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}var Zr=(t,e)=>{function n(r,...o){if(st(r),t.nonceLength!==void 0){let h=o[0];if(!h)throw new Error("nonce / iv required");t.varSizeNonce?st(h):st(h,t.nonceLength)}let s=t.tagLength;s&&o[1]!==void 0&&st(o[1]);let i=e(r,...o),c=(h,y)=>{if(y!==void 0){if(h!==2)throw new Error("cipher output not supported");st(y)}},f=!1;return{encrypt(h,y){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,st(h),c(i.encrypt.length,y),i.encrypt(h,y)},decrypt(h,y){if(st(h),s&&h.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return c(i.decrypt.length,y),i.decrypt(h,y)}}}return Object.assign(n,t),n};function Gr(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!fe(e))throw new Error("invalid output, must be aligned");return e}function vn(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,l=r?0:4;t.setUint32(e+f,i,r),t.setUint32(e+l,c,r)}function fe(t){return t.byteOffset%4===0}function vt(t){return Uint8Array.from(t)}function ut(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}var Rt=16,kn=new Uint8Array(16),_t=ft(kn),Ms=225,vs=(t,e,n,r)=>{let o=r&1;return{s3:n<<31|r>>>1,s2:e<<31|n>>>1,s1:t<<31|e>>>1,s0:t>>>1^Ms<<24&-(o&1)}},bt=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function Rs(t){t.reverse();let e=t[15]&1,n=0;for(let r=0;r<t.length;r++){let o=t[r];t[r]=o>>>1|n,n=(o&1)<<7}return t[0]^=-e&225,t}var ks=t=>t>64*1024?8:t>1024?4:2,Ve=class{constructor(e,n){this.blockLen=Rt,this.outputLen=Rt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,e=ce(e),st(e,16);let r=me(e),o=r.getUint32(0,!1),s=r.getUint32(4,!1),i=r.getUint32(8,!1),c=r.getUint32(12,!1),f=[];for(let _=0;_<128;_++)f.push({s0:bt(o),s1:bt(s),s2:bt(i),s3:bt(c)}),{s0:o,s1:s,s2:i,s3:c}=vs(o,s,i,c);let l=ks(n||1024);if(![1,2,4,8].includes(l))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;let y=128/l,m=this.windowSize=2**l,b=[];for(let _=0;_<y;_++)for(let U=0;U<m;U++){let C=0,R=0,T=0,A=0;for(let S=0;S<l;S++){if(!(U>>>l-S-1&1))continue;let{s0:H,s1:V,s2:K,s3:P}=f[l*_+S];C^=H,R^=V,T^=K,A^=P}b.push({s0:C,s1:R,s2:T,s3:A})}this.t=b}_updateBlock(e,n,r,o){e^=this.s0,n^=this.s1,r^=this.s2,o^=this.s3;let{W:s,t:i,windowSize:c}=this,f=0,l=0,h=0,y=0,m=(1<<s)-1,b=0;for(let _ of[e,n,r,o])for(let U=0;U<4;U++){let C=_>>>8*U&255;for(let R=8/s-1;R>=0;R--){let T=C>>>s*R&m,{s0:A,s1:S,s2:k,s3:H}=i[b*c+T];f^=A,l^=S,h^=k,y^=H,b+=1}}this.s0=f,this.s1=l,this.s2=h,this.s3=y}update(e){e=ce(e),be(this);let n=ft(e),r=Math.floor(e.length/Rt),o=e.length%Rt;for(let s=0;s<r;s++)this._updateBlock(n[s*4+0],n[s*4+1],n[s*4+2],n[s*4+3]);return o&&(kn.set(e.subarray(r*Rt)),this._updateBlock(_t[0],_t[1],_t[2],_t[3]),ut(_t)),this}destroy(){let{t:e}=this;for(let n of e)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(e){be(this),Mn(e,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=ft(e);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,e}digest(){let e=new Uint8Array(Rt);return this.digestInto(e),this.destroy(),e}},Rn=class extends Ve{constructor(e,n){e=ce(e);let r=Rs(vt(e));super(r,n),ut(r)}update(e){e=ce(e),be(this);let n=ft(e),r=e.length%Rt,o=Math.floor(e.length/Rt);for(let s=0;s<o;s++)this._updateBlock(bt(n[s*4+3]),bt(n[s*4+2]),bt(n[s*4+1]),bt(n[s*4+0]));return r&&(kn.set(e.subarray(o*Rt)),this._updateBlock(bt(_t[3]),bt(_t[2]),bt(_t[1]),bt(_t[0])),ut(_t)),this}digestInto(e){be(this),Mn(e,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=ft(e);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,e.reverse()}};function Wr(t){let e=(r,o)=>t(o,r.length).update(ce(r)).digest(),n=t(new Uint8Array(16),0);return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(r,o)=>t(r,o),e}var Ns=Wr((t,e)=>new Ve(t,e)),Yr=Wr((t,e)=>new Rn(t,e));var $r=16,Hs=4;var Ds=283;function Hn(t){return t<<1^Ds&-(t>>7)}function Xr(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(e&1),t=Hn(t);return n}var Fs=(()=>{let t=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=Hn(r))t[n]=r;let e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return ut(t),e})();var Ps=t=>t<<24|t>>>8,Nn=t=>t<<8|t>>>24;function Vs(t,e){if(t.length!==256)throw new Error("Wrong sbox length");let n=new Uint32Array(256).map((l,h)=>e(t[h])),r=n.map(Nn),o=r.map(Nn),s=o.map(Nn),i=new Uint32Array(256*256),c=new Uint32Array(256*256),f=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let h=0;h<256;h++){let y=l*256+h;i[y]=n[l]^r[h],c[y]=o[l]^s[h],f[y]=t[l]<<8|t[h]}return{sbox:t,sbox2:f,T0:n,T1:r,T2:o,T3:s,T01:i,T23:c}}var Qr=Vs(Fs,t=>Xr(t,3)<<24|t<<16|t<<8|Xr(t,2));var Ks=(()=>{let t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=Hn(n))t[e]=n;return t})();function Jr(t){st(t);let e=t.length;if(![16,24,32].includes(e))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+e);let{sbox2:n}=Qr,r=[];fe(t)||r.push(t=vt(t));let o=ft(t),s=o.length,i=f=>Ee(n,f,f,f,f),c=new Uint32Array(e+28);c.set(o);for(let f=s;f<c.length;f++){let l=c[f-1];f%s===0?l=i(Ps(l))^Ks[f/s-1]:s>6&&f%s===4&&(l=i(l)),c[f]=c[f-s]^l}return ut(...r),c}function Ke(t,e,n,r,o,s){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|s>>>24&255]}function Ee(t,e,n,r,o){return t[e&255|n&65280]|t[r>>>16&255|o>>>16&65280]<<16}function ze(t,e,n,r,o){let{sbox2:s,T01:i,T23:c}=Qr,f=0;e^=t[f++],n^=t[f++],r^=t[f++],o^=t[f++];let l=t.length/4-2;for(let _=0;_<l;_++){let U=t[f++]^Ke(i,c,e,n,r,o),C=t[f++]^Ke(i,c,n,r,o,e),R=t[f++]^Ke(i,c,r,o,e,n),T=t[f++]^Ke(i,c,o,e,n,r);e=U,n=C,r=R,o=T}let h=t[f++]^Ee(s,e,n,r,o),y=t[f++]^Ee(s,n,r,o,e),m=t[f++]^Ee(s,r,o,e,n),b=t[f++]^Ee(s,o,e,n,r);return{s0:h,s1:y,s2:m,s3:b}}function js(t,e,n,r,o){st(n,$r),st(r),o=Gr(r.length,o);let s=n,i=ft(s),c=me(s),f=ft(r),l=ft(o),h=e?0:12,y=r.length,m=c.getUint32(h,e),{s0:b,s1:_,s2:U,s3:C}=ze(t,i[0],i[1],i[2],i[3]);for(let T=0;T+4<=f.length;T+=4)l[T+0]=f[T+0]^b,l[T+1]=f[T+1]^_,l[T+2]=f[T+2]^U,l[T+3]=f[T+3]^C,m=m+1>>>0,c.setUint32(h,m,e),{s0:b,s1:_,s2:U,s3:C}=ze(t,i[0],i[1],i[2],i[3]);let R=$r*Math.floor(f.length/Hs);if(R<y){let T=new Uint32Array([b,_,U,C]),A=zr(T);for(let S=R,k=0;S<y;S++,k++)o[S]=r[S]^A[k];ut(T)}return o}function zs(t,e,n,r,o){let s=o==null?0:o.length,i=t.create(n,r.length+s);o&&i.update(o),i.update(r);let c=new Uint8Array(16),f=me(c);o&&vn(f,0,BigInt(s*8),e),vn(f,8,BigInt(r.length*8),e),i.update(c);let l=i.digest();return ut(c),l}var je=(t,e,n)=>r=>{if(!Number.isSafeInteger(r)||e>r||r>n){let o="["+e+".."+n+"]";throw new Error(""+t+": expected value in range "+o+", got "+r)}},Dn=Zr({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,n,r){let s=je("AAD",0,68719476736),i=je("plaintext",0,2**36),c=je("nonce",12,12),f=je("ciphertext",16,2**36+16);st(e,16,24,32),c(n.length),r!==void 0&&s(r.length);function l(){let m=Jr(e),b=new Uint8Array(e.length),_=new Uint8Array(16),U=[m,b],C=n;fe(C)||U.push(C=vt(C));let R=ft(C),T=0,A=R[0],S=R[1],k=R[2],H=0;for(let K of[_,b].map(ft)){let P=ft(K);for(let W=0;W<P.length;W+=2){let{s0:q,s1:it}=ze(m,T,A,S,k);P[W+0]=q,P[W+1]=it,T=++H}}let V={authKey:_,encKey:Jr(b)};return ut(...U),V}function h(m,b,_){let U=zs(Yr,!0,b,_,r);for(let k=0;k<12;k++)U[k]^=n[k];U[15]&=127;let C=ft(U),R=C[0],T=C[1],A=C[2],S=C[3];return{s0:R,s1:T,s2:A,s3:S}=ze(m,R,T,A,S),C[0]=R,C[1]=T,C[2]=A,C[3]=S,U}function y(m,b,_){let U=vt(b);U[15]|=128;let C=js(m,!0,U,_);return ut(U),C}return{encrypt(m){i(m.length);let{encKey:b,authKey:_}=l(),U=h(b,_,m),C=[b,_,U];fe(m)||C.push(m=vt(m));let R=new Uint8Array(m.length+16);return R.set(U,m.length),R.set(y(b,U,m)),ut(...C),R},decrypt(m){f(m.length);let b=m.subarray(-16),{encKey:_,authKey:U}=l(),C=[_,U];fe(m)||C.push(m=vt(m));let R=y(_,b,m.subarray(0,-16)),T=h(_,U,R);if(C.push(T),!qr(b,T))throw ut(...C),new Error("invalid polyval tag");return ut(...C),R}}});var Jt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Fn(t=32){if(Jt&&typeof Jt.getRandomValues=="function")return Jt.getRandomValues(new Uint8Array(t));if(Jt&&typeof Jt.randomBytes=="function")return Jt.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}var Pn;try{Pn=new TextDecoder}catch{}var M,te,g=0;var so=[],qs=105,Zs=57342,Gs=57343,to=57337;var eo=6,ae={},Be=11281e4,kt=1681e4;var Vn=so,Kn=0,D={},X,Ge,We=0,Se=0,et,mt,Q=[],jn=[],dt,at,Ae,no={useRecords:!1,mapsAsObjects:!0},Ue=!1,io=2;try{new Function("")}catch{io=1/0}var ee=class t{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,o]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,o);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,o]of Object.entries(this._keyMap))this._mapKey.set(o,r)}let n={};return e.forEach((r,o)=>n[Et(this._mapKey.has(o)?this._mapKey.get(o):o)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(o=>this.decodeKeys(o))}return r}decode(e,n){if(M)return lo(()=>(Ye(),this?this.decode(e,n):t.prototype.decode.call(no,e,n)));te=n>-1?n:e.length,g=0,Kn=0,Se=0,Ge=null,Vn=so,et=null,M=e;try{at=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw M=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof t){if(D=this,dt=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return X=this.structures,qe();(!X||X.length>0)&&(X=[])}else D=no,(!X||X.length>0)&&(X=[]),dt=null;return qe()}decodeMultiple(e,n){let r,o=0;try{let s=e.length;Ue=!0;let i=this?this.decode(e,s):Wn.decode(e,s);if(n){if(n(i)===!1)return;for(;g<s;)if(o=g,n(qe())===!1)return}else{for(r=[i];g<s;)o=g,r.push(qe());return r}}catch(s){throw s.lastPosition=o,s.values=r,s}finally{Ue=!1,Ye()}}};function qe(){try{let t=F();if(et){if(g>=et.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}g=et.postBundlePosition,et=null}if(g==te)X=null,M=null,mt&&(mt=null);else if(g>te){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!Ue)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Ye(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function F(){let t=M[g++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=M[g++];break;case 25:if(e==7)return Xs();t=at.getUint16(g),g+=2;break;case 26:if(e==7){let n=at.getFloat32(g);if(D.useFloat32>2){let r=$e[(M[g]&127)<<1|M[g+1]>>7];return g+=4,(r*n+(n>0?.5:-.5)>>0)/r}return g+=4,n}t=at.getUint32(g),g+=4;break;case 27:if(e==7){let n=at.getFloat64(g);return g+=8,n}if(e>1){if(at.getUint32(g)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=at.getUint32(g+4)}else D.int64AsNumber?(t=at.getUint32(g)*4294967296,t+=at.getUint32(g+4)):t=at.getBigUint64(g);g+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,o=0;for(;(r=F())!=ae;){if(o>=Be)throw new Error(`Array length exceeds ${Be}`);n[o++]=r}return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let s;if(D.mapsAsObjects){let i={},c=0;if(D.keyMap)for(;(s=F())!=ae;){if(c++>=kt)throw new Error(`Property count exceeds ${kt}`);i[Et(D.decodeKey(s))]=F()}else for(;(s=F())!=ae;){if(c++>=kt)throw new Error(`Property count exceeds ${kt}`);i[Et(s)]=F()}return i}else{Ae&&(D.mapsAsObjects=!0,Ae=!1);let i=new Map;if(D.keyMap){let c=0;for(;(s=F())!=ae;){if(c++>=kt)throw new Error(`Map size exceeds ${kt}`);i.set(D.decodeKey(s),F())}}else{let c=0;for(;(s=F())!=ae;){if(c++>=kt)throw new Error(`Map size exceeds ${kt}`);i.set(s,F())}}return i}case 7:return ae;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return $s(t);case 3:if(Se>=g)return Ge.slice(g-We,(g+=t)-We);if(Se==0&&te<140&&t<32){let o=t<16?co(t):Ys(t);if(o!=null)return o}return Ws(t);case 4:if(t>=Be)throw new Error(`Array length exceeds ${Be}`);let n=new Array(t);for(let o=0;o<t;o++)n[o]=F();return n;case 5:if(t>=kt)throw new Error(`Map size exceeds ${Be}`);if(D.mapsAsObjects){let o={};if(D.keyMap)for(let s=0;s<t;s++)o[Et(D.decodeKey(F()))]=F();else for(let s=0;s<t;s++)o[Et(F())]=F();return o}else{Ae&&(D.mapsAsObjects=!0,Ae=!1);let o=new Map;if(D.keyMap)for(let s=0;s<t;s++)o.set(D.decodeKey(F()),F());else for(let s=0;s<t;s++)o.set(F(),F());return o}case 6:if(t>=to){let o=X[t&8191];if(o)return o.read||(o.read=zn(o)),o.read();if(t<65536){if(t==Gs){let s=ue(),i=F(),c=F();Zn(i,c);let f={};if(D.keyMap)for(let l=2;l<s;l++){let h=D.decodeKey(c[l-2]);f[Et(h)]=F()}else for(let l=2;l<s;l++){let h=c[l-2];f[Et(h)]=F()}return f}else if(t==Zs){let s=ue(),i=F();for(let c=2;c<s;c++)Zn(i++,F());return F()}else if(t==to)return ri();if(D.getShared&&(Gn(),o=X[t&8191],o))return o.read||(o.read=zn(o)),o.read()}}let r=Q[t];if(r)return r.handlesRead?r(F):r(F());{let o=F();for(let s=0;s<jn.length;s++){let i=jn[s](t,o);if(i!==void 0)return i}return new At(o,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let o=(dt||Qt())[t];if(o!==void 0)return o;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let o=new Error("Unexpected end of CBOR data");throw o.incomplete=!0,o}throw new Error("Unknown CBOR token "+t)}}var ro=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function zn(t){if(!t)throw new Error("Structure is required in record definition");function e(){let n=M[g++];if(n=n&31,n>23)switch(n){case 24:n=M[g++];break;case 25:n=at.getUint16(g),g+=2;break;case 26:n=at.getUint32(g),g+=4;break;default:throw new Error("Expected array header, but got "+M[g-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(F);r=r.next}if(this.slowReads++>=io){let s=this.length==n?this:this.slice(0,n);return r=D.keyMap?new Function("r","return {"+s.map(i=>D.decodeKey(i)).map(i=>ro.test(i)?Et(i)+":r()":"["+JSON.stringify(i)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(i=>ro.test(i)?Et(i)+":r()":"["+JSON.stringify(i)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(F)}let o={};if(D.keyMap)for(let s=0;s<n;s++)o[Et(D.decodeKey(this[s]))]=F();else for(let s=0;s<n;s++)o[Et(this[s])]=F();return o}return t.slowReads=0,e}function Et(t){if(typeof t=="string")return t==="__proto__"?"__proto_":t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property name type "+typeof t)}var Ws=qn;function qn(t){let e;if(t<16&&(e=co(t)))return e;if(t>64&&Pn)return Pn.decode(M.subarray(g,g+=t));let n=g+t,r=[];for(e="";g<n;){let o=M[g++];if((o&128)===0)r.push(o);else if((o&224)===192){let s=M[g++]&63;r.push((o&31)<<6|s)}else if((o&240)===224){let s=M[g++]&63,i=M[g++]&63;r.push((o&31)<<12|s<<6|i)}else if((o&248)===240){let s=M[g++]&63,i=M[g++]&63,c=M[g++]&63,f=(o&7)<<18|s<<12|i<<6|c;f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|f&1023),r.push(f)}else r.push(o);r.length>=4096&&(e+=rt.apply(String,r),r.length=0)}return r.length>0&&(e+=rt.apply(String,r)),e}var rt=String.fromCharCode;function Ys(t){let e=g,n=new Array(t);for(let r=0;r<t;r++){let o=M[g++];if((o&128)>0){g=e;return}n[r]=o}return rt.apply(String,n)}function co(t){if(t<4)if(t<2){if(t===0)return"";{let e=M[g++];if((e&128)>1){g-=1;return}return rt(e)}}else{let e=M[g++],n=M[g++];if((e&128)>0||(n&128)>0){g-=2;return}if(t<3)return rt(e,n);let r=M[g++];if((r&128)>0){g-=3;return}return rt(e,n,r)}else{let e=M[g++],n=M[g++],r=M[g++],o=M[g++];if((e&128)>0||(n&128)>0||(r&128)>0||(o&128)>0){g-=4;return}if(t<6){if(t===4)return rt(e,n,r,o);{let s=M[g++];if((s&128)>0){g-=5;return}return rt(e,n,r,o,s)}}else if(t<8){let s=M[g++],i=M[g++];if((s&128)>0||(i&128)>0){g-=6;return}if(t<7)return rt(e,n,r,o,s,i);let c=M[g++];if((c&128)>0){g-=7;return}return rt(e,n,r,o,s,i,c)}else{let s=M[g++],i=M[g++],c=M[g++],f=M[g++];if((s&128)>0||(i&128)>0||(c&128)>0||(f&128)>0){g-=8;return}if(t<10){if(t===8)return rt(e,n,r,o,s,i,c,f);{let l=M[g++];if((l&128)>0){g-=9;return}return rt(e,n,r,o,s,i,c,f,l)}}else if(t<12){let l=M[g++],h=M[g++];if((l&128)>0||(h&128)>0){g-=10;return}if(t<11)return rt(e,n,r,o,s,i,c,f,l,h);let y=M[g++];if((y&128)>0){g-=11;return}return rt(e,n,r,o,s,i,c,f,l,h,y)}else{let l=M[g++],h=M[g++],y=M[g++],m=M[g++];if((l&128)>0||(h&128)>0||(y&128)>0||(m&128)>0){g-=12;return}if(t<14){if(t===12)return rt(e,n,r,o,s,i,c,f,l,h,y,m);{let b=M[g++];if((b&128)>0){g-=13;return}return rt(e,n,r,o,s,i,c,f,l,h,y,m,b)}}else{let b=M[g++],_=M[g++];if((b&128)>0||(_&128)>0){g-=14;return}if(t<15)return rt(e,n,r,o,s,i,c,f,l,h,y,m,b,_);let U=M[g++];if((U&128)>0){g-=15;return}return rt(e,n,r,o,s,i,c,f,l,h,y,m,b,_,U)}}}}}function $s(t){return D.copyBuffers?Uint8Array.prototype.slice.call(M,g,g+=t):M.subarray(g,g+=t)}var fo=new Float32Array(1),Ze=new Uint8Array(fo.buffer,0,4);function Xs(){let t=M[g++],e=M[g++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return Ze[3]=t&128|(n>>1)+56,Ze[2]=(t&7)<<5|e>>3,Ze[1]=e<<5,Ze[0]=0,fo[0]}var Fc=new Array(4096);var At=class{constructor(e,n){this.value=e,this.tag=n}};Q[0]=t=>new Date(t);Q[1]=t=>new Date(Math.round(t*1e3));Q[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+(e<<BigInt(8));return e};Q[3]=t=>BigInt(-1)-Q[2](t);Q[4]=t=>+(t[1]+"e"+t[0]);Q[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));var Zn=(t,e)=>{t=t-57344;let n=X[t];n&&n.isShared&&((X.restoreStructures||(X.restoreStructures=[]))[t]=n),X[t]=e,e.read=zn(e)};Q[qs]=t=>{let e=t.length,n=t[1];Zn(t[0],n);let r={};for(let o=2;o<e;o++){let s=n[o-2];r[Et(s)]=t[o]}return r};Q[14]=t=>et?et[0].slice(et.position0,et.position0+=t):new At(t,14);Q[15]=t=>et?et[1].slice(et.position1,et.position1+=t):new At(t,15);var Js={Error,RegExp};Q[27]=t=>(Js[t[0]]||Error)(t[1],t[2]);var ao=t=>{if(M[g++]!=132){let n=new Error("Packed values structure must be followed by a 4 element array");throw M.length<g&&(n.incomplete=!0),n}let e=t();if(!e||!e.length){let n=new Error("Packed values structure must be followed by a 4 element array");throw n.incomplete=!0,n}return dt=dt?e.concat(dt.slice(e.length)):e,dt.prefixes=t(),dt.suffixes=t(),t()};ao.handlesRead=!0;Q[51]=ao;Q[eo]=t=>{if(!dt)if(D.getShared)Gn();else return new At(t,eo);if(typeof t=="number")return dt[16+(t>=0?2*t:-2*t-1)];let e=new Error("No support for non-integer packed references yet");throw t===void 0&&(e.incomplete=!0),e};Q[28]=t=>{mt||(mt=new Map,mt.id=0);let e=mt.id++,n=g,r=M[g],o;r>>5==4?o=[]:o={};let s={target:o};mt.set(e,s);let i=t();return s.used?(Object.getPrototypeOf(o)!==Object.getPrototypeOf(i)&&(g=n,o=i,mt.set(e,{target:o}),i=t()),Object.assign(o,i)):(s.target=i,i)};Q[28].handlesRead=!0;Q[29]=t=>{let e=mt.get(t);return e.used=!0,e.target};Q[258]=t=>new Set(t);(Q[259]=t=>(D.mapsAsObjects&&(D.mapsAsObjects=!1,Ae=!0),t())).handlesRead=!0;function le(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Qt(){if(!dt)if(D.getShared)Gn();else throw new Error("No packed values available");return dt}var Qs=1399353956;jn.push((t,e)=>{if(t>=225&&t<=255)return le(Qt().prefixes[t-224],e);if(t>=28704&&t<=32767)return le(Qt().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return le(Qt().prefixes[t-1879048192],e);if(t>=216&&t<=223)return le(e,Qt().suffixes[t-216]);if(t>=27647&&t<=28671)return le(e,Qt().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return le(e,Qt().suffixes[t-1811939328]);if(t==Qs)return{packedValues:dt,structures:X.slice(0),version:e};if(t==55799)return e});var ti=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,oo=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],ei=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<oo.length;t++)ni(oo[t],ei[t]);function ni(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let o=0;o<2;o++){if(!o&&r==1)continue;let s=r==2?1:r==4?2:r==8?3:0;Q[o?e:e-4]=r==1||o==ti?i=>{if(!t)throw new Error("Could not find typed array for code "+e);return!D.copyBuffers&&(r===1||r===2&&!(i.byteOffset&1)||r===4&&!(i.byteOffset&3)||r===8&&!(i.byteOffset&7))?new t(i.buffer,i.byteOffset,i.byteLength>>s):new t(Uint8Array.prototype.slice.call(i,0).buffer)}:i=>{if(!t)throw new Error("Could not find typed array for code "+e);let c=new DataView(i.buffer,i.byteOffset,i.byteLength),f=i.length>>s,l=new t(f),h=c[n];for(let y=0;y<f;y++)l[y]=h.call(c,y<<s,o);return l}}}function ri(){let t=ue(),e=g+F();for(let r=2;r<t;r++){let o=ue();g+=o}let n=g;return g=e,et=[qn(ue()),qn(ue())],et.position0=0,et.position1=0,et.postBundlePosition=g,g=n,F()}function ue(){let t=M[g++]&31;if(t>23)switch(t){case 24:t=M[g++];break;case 25:t=at.getUint16(g),g+=2;break;case 26:t=at.getUint32(g),g+=4;break}return t}function Gn(){if(D.getShared){let t=lo(()=>(M=null,D.getShared()))||{},e=t.structures||[];D.sharedVersion=t.version,dt=D.sharedValues=t.packedValues,X===!0?D.structures=X=e:X.splice.apply(X,[0,e.length].concat(e))}}function lo(t){let e=te,n=g,r=Kn,o=We,s=Se,i=Ge,c=Vn,f=mt,l=et,h=new Uint8Array(M.slice(0,te)),y=X,m=D,b=Ue,_=t();return te=e,g=n,Kn=r,We=o,Se=s,Ge=i,Vn=c,mt=f,et=l,M=h,Ue=b,X=y,D=m,at=new DataView(M.buffer,M.byteOffset,M.byteLength),_}function Ye(){M=null,mt=null,X=null}var $e=new Array(147);for(let t=0;t<256;t++)$e[t]=+("1e"+Math.floor(45.15-t*.30103));var Wn=new ee({useRecords:!1}),Ie=Wn.decode,oi=Wn.decodeMultiple,Xe={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};var Je;try{Je=new TextEncoder}catch{}var Qn,go,en=typeof globalThis=="object"&&globalThis.Buffer,Oe=typeof en<"u",Yn=Oe?en.allocUnsafeSlow:Uint8Array,uo=Oe?en:Uint8Array,ho=256,po=Oe?4294967296:2144337920;var $n,p,G,a=0,zt,nt=null,si=61440,ii=/[\u0080-\uFFFF]/,xt=Symbol("record-id"),_e=class extends ee{constructor(e){super(e),this.offset=0;let n,r,o,s,i,c;e=e||{};let f=uo.prototype.utf8Write?function(d,L,E){return p.utf8Write(d,L,E)}:Je&&Je.encodeInto?function(d,L){return Je.encodeInto(d,p.subarray(L)).written}:!1,l=this,h=e.structures||e.saveStructures,y=e.maxSharedStructures;if(y==null&&(y=h?128:0),y>8190)throw new Error("Maximum maxSharedStructure is 8190");let m=e.sequential;m&&(y=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let b,_,U=e.sharedValues,C;if(U){C=Object.create(null);for(let d=0,L=U.length;d<L;d++)C[U[d]]=d}let R=[],T=0,A=0;this.mapEncode=function(d,L){if(this._keyMap&&!this._mapped)switch(d.constructor.name){case"Array":d=d.map(E=>this.encodeKeys(E));break}return this.encode(d,L)},this.encode=function(d,L){if(p||(p=new Yn(8192),G=new DataView(p.buffer,0,8192),a=0),zt=p.length-10,zt-a<2048?(p=new Yn(p.length),G=new DataView(p.buffer,0,p.length),zt=p.length-10,a=0):L===er&&(a=a+7&2147483640),r=a,l.useSelfDescribedHeader&&(G.setUint32(a,3654940416),a+=3),c=l.structuredClone?new Map:null,l.bundleStrings&&typeof d!="string"?(nt=[],nt.size=1/0):nt=null,o=l.structures,o){if(o.uninitialized){let x=l.getShared()||{};l.structures=o=x.structures||[],l.sharedVersion=x.version;let u=l.sharedValues=x.packedValues;if(u){C={};for(let w=0,B=u.length;w<B;w++)C[u[w]]=w}}let E=o.length;if(E>y&&!m&&(E=y),!o.transitions){o.transitions=Object.create(null);for(let x=0;x<E;x++){let u=o[x];if(!u)continue;let w,B=o.transitions;for(let I=0,O=u.length;I<O;I++){B[xt]===void 0&&(B[xt]=x);let v=u[I];w=B[v],w||(w=B[v]=Object.create(null)),B=w}B[xt]=x|1048576}}m||(o.nextId=E)}if(s&&(s=!1),i=o||[],_=C,e.pack){let E=new Map;if(E.values=[],E.encoder=l,E.maxValues=e.maxPrivatePackedValues||(C?16:1/0),E.objectMap=C||!1,E.samplingPackedValues=b,Qe(d,E),E.values.length>0){p[a++]=216,p[a++]=51,Lt(4);let x=E.values;S(x),Lt(0),Lt(0),_=Object.create(C||null);for(let u=0,w=x.length;u<w;u++)_[x[u]]=u}}$n=L&Jn;try{if($n)return;if(S(d),nt&&yo(r,S),l.offset=a,c&&c.idsToInsert){a+=c.idsToInsert.length*2,a>zt&&H(a),l.offset=a;let E=ai(p.subarray(r,a),c.idsToInsert);return c=null,E}return L&er?(p.start=r,p.end=a,p):p.subarray(r,a)}finally{if(o){if(A<10&&A++,o.length>y&&(o.length=y),T>1e4)o.transitions=null,A=0,T=0,R.length>0&&(R=[]);else if(R.length>0&&!m){for(let E=0,x=R.length;E<x;E++)R[E][xt]=void 0;R=[]}}if(s&&l.saveShared){l.structures.length>y&&(l.structures=l.structures.slice(0,y));let E=p.subarray(r,a);return l.updateSharedData()===!1?l.encode(d):E}L&yi&&(a=r)}},this.findCommonStringsToPack=()=>(b=new Map,C||(C=Object.create(null)),d=>{let L=d&&d.threshold||4,E=this.pack?d.maxPrivatePackedValues||16:0;U||(U=this.sharedValues=[]);for(let[x,u]of b)u.count>L&&(C[x]=E++,U.push(x),s=!0);for(;this.saveShared&&this.updateSharedData()===!1;);b=null});let S=d=>{a>zt&&(p=H(a));var L=typeof d,E;if(L==="string"){if(_){let B=_[d];if(B>=0){B<16?p[a++]=B+224:(p[a++]=198,B&1?S(15-B>>1):S(B-16>>1));return}else if(b&&!e.pack){let I=b.get(d);I?I.count++:b.set(d,{count:1})}}let x=d.length;if(nt&&x>=4&&x<1024){if((nt.size+=x)>si){let I,O=(nt[0]?nt[0].length*3+nt[1].length:0)+10;a+O>zt&&(p=H(a+O)),p[a++]=217,p[a++]=223,p[a++]=249,p[a++]=nt.position?132:130,p[a++]=26,I=a-r,a+=4,nt.position&&yo(r,S),nt=["",""],nt.size=0,nt.position=I}let B=ii.test(d);nt[B?0:1]+=d,p[a++]=B?206:207,S(x);return}let u;x<32?u=1:x<256?u=2:x<65536?u=3:u=5;let w=x*3;if(a+w>zt&&(p=H(a+w)),x<64||!f){let B,I,O,v=a+u;for(B=0;B<x;B++)I=d.charCodeAt(B),I<128?p[v++]=I:I<2048?(p[v++]=I>>6|192,p[v++]=I&63|128):(I&64512)===55296&&((O=d.charCodeAt(B+1))&64512)===56320?(I=65536+((I&1023)<<10)+(O&1023),B++,p[v++]=I>>18|240,p[v++]=I>>12&63|128,p[v++]=I>>6&63|128,p[v++]=I&63|128):(p[v++]=I>>12|224,p[v++]=I>>6&63|128,p[v++]=I&63|128);E=v-a-u}else E=f(d,a+u,w);E<24?p[a++]=96|E:E<256?(u<2&&p.copyWithin(a+2,a+1,a+1+E),p[a++]=120,p[a++]=E):E<65536?(u<3&&p.copyWithin(a+3,a+2,a+2+E),p[a++]=121,p[a++]=E>>8,p[a++]=E&255):(u<5&&p.copyWithin(a+5,a+3,a+3+E),p[a++]=122,G.setUint32(a,E),a+=4),a+=E}else if(L==="number")if(!this.alwaysUseFloat&&d>>>0===d)d<24?p[a++]=d:d<256?(p[a++]=24,p[a++]=d):d<65536?(p[a++]=25,p[a++]=d>>8,p[a++]=d&255):(p[a++]=26,G.setUint32(a,d),a+=4);else if(!this.alwaysUseFloat&&d>>0===d)d>=-24?p[a++]=31-d:d>=-256?(p[a++]=56,p[a++]=~d):d>=-65536?(p[a++]=57,G.setUint16(a,~d),a+=2):(p[a++]=58,G.setUint32(a,~d),a+=4);else{let x;if((x=this.useFloat32)>0&&d<4294967296&&d>=-2147483648){p[a++]=250,G.setFloat32(a,d);let u;if(x<4||(u=d*$e[(p[a]&127)<<1|p[a+1]>>7])>>0===u){a+=4;return}else a--}p[a++]=251,G.setFloat64(a,d),a+=8}else if(L==="object")if(!d)p[a++]=246;else{if(c){let u=c.get(d);if(u){if(p[a++]=216,p[a++]=29,p[a++]=25,!u.references){let w=c.idsToInsert||(c.idsToInsert=[]);u.references=[],w.push(u)}u.references.push(a-r),a+=2;return}else c.set(d,{offset:a-r})}let x=d.constructor;if(x===Object)k(d);else if(x===Array){E=d.length,E<24?p[a++]=128|E:Lt(E);for(let u=0;u<E;u++)S(d[u])}else if(x===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(p[a++]=217,p[a++]=1,p[a++]=3),E=d.size,E<24?p[a++]=160|E:E<256?(p[a++]=184,p[a++]=E):E<65536?(p[a++]=185,p[a++]=E>>8,p[a++]=E&255):(p[a++]=186,G.setUint32(a,E),a+=4),l.keyMap)for(let[u,w]of d)S(l.encodeKey(u)),S(w);else for(let[u,w]of d)S(u),S(w);else{for(let u=0,w=Qn.length;u<w;u++){let B=go[u];if(d instanceof B){let I=Qn[u],O=I.tag;O==null&&(O=I.getTag&&I.getTag.call(this,d)),O<24?p[a++]=192|O:O<256?(p[a++]=216,p[a++]=O):O<65536?(p[a++]=217,p[a++]=O>>8,p[a++]=O&255):O>-1&&(p[a++]=218,G.setUint32(a,O),a+=4),I.encode.call(this,d,S,H);return}}if(d[Symbol.iterator]){if($n){let u=new Error("Iterable should be serialized as iterator");throw u.iteratorNotHandled=!0,u}p[a++]=159;for(let u of d)S(u);p[a++]=255;return}if(d[Symbol.asyncIterator]||Xn(d)){let u=new Error("Iterable/blob should be serialized as iterator");throw u.iteratorNotHandled=!0,u}if(this.useToJSON&&d.toJSON){let u=d.toJSON();if(u!==d)return S(u)}k(d)}}else if(L==="boolean")p[a++]=d?245:244;else if(L==="bigint"){if(d<BigInt(1)<<BigInt(64)&&d>=0)p[a++]=27,G.setBigUint64(a,d);else if(d>-(BigInt(1)<<BigInt(64))&&d<0)p[a++]=59,G.setBigUint64(a,-d-BigInt(1));else if(this.largeBigIntToFloat)p[a++]=251,G.setFloat64(a,Number(d));else{d>=BigInt(0)?p[a++]=194:(p[a++]=195,d=BigInt(-1)-d);let x=[];for(;d;)x.push(Number(d&BigInt(255))),d>>=BigInt(8);tr(new Uint8Array(x.reverse()),H);return}a+=8}else if(L==="undefined")p[a++]=247;else throw new Error("Unknown type: "+L)},k=this.useRecords===!1?this.variableMapSize?d=>{let L=Object.keys(d),E=Object.values(d),x=L.length;x<24?p[a++]=160|x:x<256?(p[a++]=184,p[a++]=x):x<65536?(p[a++]=185,p[a++]=x>>8,p[a++]=x&255):(p[a++]=186,G.setUint32(a,x),a+=4);let u;if(l.keyMap)for(let w=0;w<x;w++)S(l.encodeKey(L[w])),S(E[w]);else for(let w=0;w<x;w++)S(L[w]),S(E[w])}:d=>{p[a++]=185;let L=a-r;a+=2;let E=0;if(l.keyMap)for(let x in d)(typeof d.hasOwnProperty!="function"||d.hasOwnProperty(x))&&(S(l.encodeKey(x)),S(d[x]),E++);else for(let x in d)(typeof d.hasOwnProperty!="function"||d.hasOwnProperty(x))&&(S(x),S(d[x]),E++);p[L+++r]=E>>8,p[L+r]=E&255}:(d,L)=>{let E,x=i.transitions||(i.transitions=Object.create(null)),u=0,w=0,B,I;if(this.keyMap){I=Object.keys(d).map(v=>this.encodeKey(v)),w=I.length;for(let v=0;v<w;v++){let Z=I[v];E=x[Z],E||(E=x[Z]=Object.create(null),u++),x=E}}else for(let v in d)(typeof d.hasOwnProperty!="function"||d.hasOwnProperty(v))&&(E=x[v],E||(x[xt]&1048576&&(B=x[xt]&65535),E=x[v]=Object.create(null),u++),x=E,w++);let O=x[xt];if(O!==void 0)O&=65535,p[a++]=217,p[a++]=O>>8|224,p[a++]=O&255;else if(I||(I=x.__keys__||(x.__keys__=Object.keys(d))),B===void 0?(O=i.nextId++,O||(O=0,i.nextId=1),O>=ho&&(i.nextId=(O=y)+1)):O=B,i[O]=I,O<y){p[a++]=217,p[a++]=O>>8|224,p[a++]=O&255,x=i.transitions;for(let v=0;v<w;v++)(x[xt]===void 0||x[xt]&1048576)&&(x[xt]=O),x=x[I[v]];x[xt]=O|1048576,s=!0}else{if(x[xt]=O,G.setUint32(a,3655335680),a+=3,u&&(T+=A*u),R.length>=ho-y&&(R.shift()[xt]=void 0),R.push(x),Lt(w+2),S(57344+O),S(I),L)return;for(let v in d)(typeof d.hasOwnProperty!="function"||d.hasOwnProperty(v))&&S(d[v]);return}if(w<24?p[a++]=128|w:Lt(w),!L)for(let v in d)(typeof d.hasOwnProperty!="function"||d.hasOwnProperty(v))&&S(d[v])},H=d=>{let L;if(d>16777216){if(d-r>po)throw new Error("Encoded buffer would be larger than maximum buffer size");L=Math.min(po,Math.round(Math.max((d-r)*(d>67108864?1.25:2),4194304)/4096)*4096)}else L=(Math.max(d-r<<2,p.length-1)>>12)+1<<12;let E=new Yn(L);return G=new DataView(E.buffer,0,L),p.copy?p.copy(E,0,r,d):E.set(p.slice(r,d)),a-=r,r=0,zt=E.length-10,p=E},V=100,K=1e3;this.encodeAsIterable=function(d,L){return it(d,L,P)},this.encodeAsAsyncIterable=function(d,L){return it(d,L,yt)};function*P(d,L,E){let x=d.constructor;if(x===Object){let u=l.useRecords!==!1;u?k(d,!0):xo(Object.keys(d).length,160);for(let w in d){let B=d[w];u||S(w),B&&typeof B=="object"?L[w]?yield*P(B,L[w]):yield*W(B,L,w):S(B)}}else if(x===Array){let u=d.length;Lt(u);for(let w=0;w<u;w++){let B=d[w];B&&(typeof B=="object"||a-r>V)?L.element?yield*P(B,L.element):yield*W(B,L,"element"):S(B)}}else if(d[Symbol.iterator]&&!d.buffer){p[a++]=159;for(let u of d)u&&(typeof u=="object"||a-r>V)?L.element?yield*P(u,L.element):yield*W(u,L,"element"):S(u);p[a++]=255}else Xn(d)?(xo(d.size,64),yield p.subarray(r,a),yield d,q()):d[Symbol.asyncIterator]?(p[a++]=159,yield p.subarray(r,a),yield d,q(),p[a++]=255):S(d);E&&a>r?yield p.subarray(r,a):a-r>V&&(yield p.subarray(r,a),q())}function*W(d,L,E){let x=a-r;try{S(d),a-r>V&&(yield p.subarray(r,a),q())}catch(u){if(u.iteratorNotHandled)L[E]={},a=r+x,yield*P.call(this,d,L[E]);else throw u}}function q(){V=K,l.encode(null,Jn)}function it(d,L,E){return L&&L.chunkThreshold?V=K=L.chunkThreshold:V=100,d&&typeof d=="object"?(l.encode(null,Jn),E(d,l.iterateProperties||(l.iterateProperties={}),!0)):[l.encode(d)]}async function*yt(d,L){for(let E of P(d,L,!0)){let x=E.constructor;if(x===uo||x===Uint8Array)yield E;else if(Xn(E)){let u=E.stream().getReader(),w;for(;!(w=await u.read()).done;)yield w.value}else if(E[Symbol.asyncIterator])for await(let u of E)q(),u?yield*yt(u,L.async||(L.async={})):yield l.encode(u);else yield E}}}useBuffer(e){p=e,G=new DataView(p.buffer,p.byteOffset,p.byteLength),a=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new tn(n,this.sharedValues,this.sharedVersion),o=this.saveShared(r,s=>(s&&s.version||0)==e);return o===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((s,i)=>this.structures[i]=s),o}};function xo(t,e){t<24?p[a++]=e|t:t<256?(p[a++]=e|24,p[a++]=t):t<65536?(p[a++]=e|25,p[a++]=t>>8,p[a++]=t&255):(p[a++]=e|26,G.setUint32(a,t),a+=4)}var tn=class{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}};function Lt(t){t<24?p[a++]=128|t:t<256?(p[a++]=152,p[a++]=t):t<65536?(p[a++]=153,p[a++]=t>>8,p[a++]=t&255):(p[a++]=154,G.setUint32(a,t),a+=4)}var ci=typeof Blob>"u"?function(){}:Blob;function Xn(t){if(t instanceof ci)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function Qe(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let o=e.samplingPackedValues.get(t);o?o.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,o=t.length;r<o;r++)Qe(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&Qe(n,e),Qe(t[n],e))}break;case"function":console.log(t)}}var fi=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;go=[Date,Set,Error,RegExp,At,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,tn];Qn=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(p[a++]=26,G.setUint32(a,n),a+=4):(p[a++]=251,G.setFloat64(a,n),a+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){tr(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Oe&&this.tagUint8Array!==!1))return 64},encode(t,e,n){tr(t,n)}},Ot(68,1),Ot(69,2),Ot(70,4),Ot(71,8),Ot(72,1),Ot(77,2),Ot(78,4),Ot(79,8),Ot(85,4),Ot(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){p[a++]=216,p[a++]=51,Lt(4);let o=n.values;e(o),Lt(0),Lt(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,i=o.length;s<i;s++)packedObjectMap[o[s]]=s}if(r){G.setUint32(a,3655335424),a+=3;let o=r.slice(0);o.unshift(57344),o.push(new At(t.version,1399353956)),e(o)}else e(new At(t.version,1399353956))}}];function Ot(t,e){return!fi&&e>1&&(t-=4),{tag:t,encode:function(r,o){let s=r.byteLength,i=r.byteOffset||0,c=r.buffer||r;o(Oe?en.from(c,i,s):new Uint8Array(c,i,s))}}}function tr(t,e){let n=t.byteLength;n<24?p[a++]=64+n:n<256?(p[a++]=88,p[a++]=n):n<65536?(p[a++]=89,p[a++]=n>>8,p[a++]=n&255):(p[a++]=90,G.setUint32(a,n),a+=4),a+n>=p.length&&e(a+n),p.set(t.buffer?t:new Uint8Array(t),a),a+=n}function ai(t,e){let n,r=e.length*2,o=t.length-r;e.sort((s,i)=>s.offset>i.offset?1:-1);for(let s=0;s<e.length;s++){let i=e[s];i.id=s;for(let c of i.references)t[c++]=s>>8,t[c]=s&255}for(;n=e.pop();){let s=n.offset;t.copyWithin(s+r,s,o),r-=2;let i=s+r;t[i++]=216,t[i++]=28,o=s}return t}function yo(t,e){G.setUint32(nt.position+t,a-nt.position-t+1);let n=nt;nt=null,e(n[0]),e(n[1])}var nr=new _e({useRecords:!1}),Le=nr.encode,li=nr.encodeAsIterable,ui=nr.encodeAsAsyncIterable,{NEVER:di,ALWAYS:hi,DECIMAL_ROUND:pi,DECIMAL_FIT:xi}=Xe,er=512,yi=1024,Jn=2048;function gi(t){let e="";t.forEach(n=>{e+=String.fromCharCode(n)});try{return btoa(e)}catch(n){throw new Error(`Failed to encode bytes to base64: ${n.message}`)}}function wi(t){try{let e=atob(t);return Uint8Array.from(e,n=>n.codePointAt(0))}catch(e){throw new Error(`Failed to decode base64 string: ${e.message}`)}}var z=(t,e)=>{let[n,r]=Object.entries(t)[0],o=typeof r,s=r?.constructor?.name;if(e==="string"){if(o!=="string")throw new Error(`${n} [${o}] is not an instance of [string].`)}else if(e==="boolean"){if(o!=="boolean")throw new Error(`${n} [${o}] is not an instance of [boolean].`)}else if(e===Uint8Array){if(!(r instanceof Uint8Array))throw new Error(`${n} [${s||o}] is not an instance of [Uint8Array].`)}else if(!(r instanceof e))throw new Error(`${n} [${s||o}] is not an instance of [${e.name}].`)};function wo(t){let e=new TextEncoder().encode("suite25519-aes-key");return jr(ar,t,void 0,e,32)}function bo(t,e){z({receiverPublicKeyEd:t},Uint8Array),z({messageUint8Array:e},Uint8Array);try{let n=Nr(t),r=we.utils.randomPrivateKey(),o=we.getPublicKey(r),s=we.getSharedSecret(r,n),i=wo(s),c=Fn(12);return{C:Dn(i,c).encrypt(e),P_e:o,N:c}}catch(n){throw new Error(`eciesEncrypt failed: ${n?.message}`)}}function mo(t,e,n,r){z({receiverPrivateKeyEd:t},Uint8Array),z({ephemeralPublicKeyX:e},Uint8Array),z({nonce:n},Uint8Array),z({ciphertext:r},Uint8Array);try{let o=Hr(t),s=we.getSharedSecret(o,e),i=wo(s),c=Dn(i,n),f;try{f=c.decrypt(r)}catch(l){throw console.error("AES-SIV decryption failed:",l),new Error("Decryption failed (authentication tag mismatch or other error)")}return f}catch(o){throw new Error(`eciesDecrypt failed: ${o?.message}`)}}var qt=class t{constructor(e){z({data:e},Uint8Array),this.data=e}toBinary(){return this.data}toBase64(){return gi(this.data)}static fromBase64(e,n=t){z({base64Data:e},"string");try{let r=wi(e);return new n(r)}catch(r){throw new Error(`Failed to decode base64 for ${n.name}: ${r.message}`)}}},Te=class extends qt{},ht=class t extends qt{constructor(e){let n;if(e instanceof Uint8Array)n=e;else if(typeof e=="string")n=new TextEncoder().encode(e);else{let r=typeof e;throw e&&typeof e=="object"&&(r=e.constructor?.name||"Object"),new Error(`Invalid data type for Message constructor: Expected string or Uint8Array, got ${r}`)}super(n)}static randomBytes(e=32){return new t(Fn(e))}toString(){try{return new TextDecoder().decode(this.data)}catch(e){return console.error("Failed to decode message data as UTF-8:",e),nn(this.data)}}},de=class t extends qt{static randomPrivateKey(){return new t(Xt.utils.randomPrivateKey())}get publicKey(){let e=Xt.getPublicKey(this.data);return new Zt(e)}decrypt(e){z({encryptedPayload:e},Uint8Array);let{C:n,P_e:r,N:o}=Ie(e);z({C:n},Uint8Array),z({P_e:r},Uint8Array),z({N:o},Uint8Array);let s=mo(this.data,r,o,n);return new ht(s)}sign(e){let n=e instanceof ht?e:new ht(e),r=Xt.sign(n.toBinary(),this.data);return new Te(r)}exportAsBase64(){return this.toBase64()}static importFromBase64(e){return qt.fromBase64(e,t)}},Zt=class t extends qt{get id(){return nn(Vr(this.data))}verify(e,n){let r=e instanceof ht?e:new ht(e);z({signature:n},Te);let o=!1;try{o=Xt.verify(n.toBinary(),r.toBinary(),this.data,{zip215:!1})}catch(s){return console.error("Verification error:",s),!1}return!!o}encrypt(e){let n=e instanceof ht?e:new ht(e),r=bo(this.data,n.toBinary());return Le(r)}exportAsBase64(){return this.toBase64()}static importFromBase64(e){return qt.fromBase64(e,t)}},bi=(t,e,n=!1,r=!1)=>{z({signingPrivateKey:e},de),z({includeMessage:n},"boolean"),z({includeSenderPublicKey:r},"boolean");let s=(t instanceof ht?t:new ht(t)).toBinary(),c={sig:Xt.sign(s,e.toBinary())};return n&&(c.m=s),r&&(c.P=e.publicKey.toBinary()),Le(c)},mi=(t,e)=>{z({signedPayload:t},Uint8Array),z({senderPublicKey:e},Zt);let n=Ie(t),{sig:r,m:o,P:s}=n;if(!r||!(r instanceof Uint8Array))throw new Error("Invalid signed payload: Missing or invalid signature.");if(o!==void 0&&!(o instanceof Uint8Array))throw new Error('Invalid signed payload: Included message "m" is not Uint8Array.');if(s!==void 0&&!(s instanceof Uint8Array))throw new Error('Invalid signed payload: Included public key "P" is not Uint8Array.');if(s&&new Zt(s).id!==e.id)throw new Error("Verification failed: Included public key 'P' does not match expected senderPublicKey.");if(o===void 0)throw new Error("Verification failed: Message 'm' not included in the signed payload.");let i=new Te(r),c=new ht(o);if(!e.verify(c,i))throw new Error("Verification failed: Invalid signature.");return o},Ei=(t,e)=>{z({recipientPublicKey:e},Zt);let r=(t instanceof ht?t:new ht(t)).toBinary(),o=bo(e.toBinary(),r);return Le(o)},Bi=(t,e)=>{z({encryptedPayload:t},Uint8Array),z({recipientPrivateKey:e},de);let{C:n,P_e:r,N:o}=Ie(t);if(!(n instanceof Uint8Array)||!(r instanceof Uint8Array)||!(o instanceof Uint8Array))throw new Error("Invalid encrypted payload structure after CBOR decoding.");return mo(e.toBinary(),r,o,n)},xf=(t,e,n,r=!0)=>{z({signingPrivateKey:e},de),z({recipientPublicKey:n},Zt),z({includeSenderPublicKey:r},"boolean");let o=bi(t,e,!0,r);return Ei(o,n)},yf=(t,e,n)=>{z({encryptedSignedPayload:t},Uint8Array),z({recipientPrivateKey:e},de),z({senderPublicKey:n},Zt);let r=Bi(t,e);return mi(r,n)};export{ht as Message,de as PrivateKey,Zt as PublicKey,yf as decryptAndVerifyMessage,Bi as decryptMessage,Ei as encryptMessage,xf as signAndEncryptMessage,bi as signMessage,mi as verifyMessage};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=suite25519.esm.js.map
